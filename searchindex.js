Search.setIndex({"docnames": ["Executable", "Introduction", "Library", "Pytorch", "Run", "index", "usage"], "filenames": ["Executable.rst", "Introduction.rst", "Library.rst", "Pytorch.rst", "Run.rst", "index.rst", "usage.rst"], "titles": ["<span class=\"section-number\">1. </span>Executable", "<span class=\"section-number\">1. </span>Introduction", "<span class=\"section-number\">2. </span>Library", "<span class=\"section-number\">4. </span>PyTorch Models", "<span class=\"section-number\">3. </span>Run FitSNAP", "Welcome to FitSNAP\u2019s documentation!", "<span class=\"section-number\">2. </span>Usage"], "terms": {"when": [0, 3], "run": [0, 3, 5, 6], "fitsnap": [0, 3, 6], "an": [0, 2, 3], "python": [0, 2, 4, 6], "m": [0, 4], "fitsnap3": [0, 4], "input": [0, 2, 3, 5], "i": [0, 1, 2, 3, 4, 5, 6], "certain": [0, 4], "sequenc": [0, 2], "function": [0, 1, 2, 3], "explain": [0, 3, 4, 6], "here": [0, 3], "code": [0, 2], "__main__": 0, "py": [0, 2], "specif": [0, 2, 3], "main": 0, "us": [0, 1, 2, 3, 4, 6], "librari": [0, 5], "follow": [0, 2, 4, 6], "perform": [0, 1, 2, 3, 4], "fit": [0, 2, 4, 5, 6], "machin": [1, 2, 4, 5], "learn": [1, 2, 3, 4, 5], "softwar": 1, "focus": 1, "model": [1, 2, 5], "how": [1, 3, 4, 6], "interatom": [1, 4], "interact": 1, "potenti": [1, 2, 4, 5, 6], "energi": [1, 2, 3, 4], "depend": [0, 1, 2], "geometri": [1, 4], "between": 1, "atom": [1, 2, 3, 4], "In": [1, 4, 6], "thi": [0, 1, 2, 3, 6], "sens": 1, "problem": [1, 2, 4], "map": [1, 2], "coordin": 1, "sinc": [1, 2], "physic": 1, "ar": [0, 1, 2, 3, 4, 6], "invari": 1, "translat": 1, "rotat": 1, "permut": 1, "we": [0, 1, 2, 3, 4, 6], "must": [1, 2, 3, 4, 6], "describ": [1, 4], "wai": [1, 4, 6], "symmetri": 1, "satisfi": 1, "do": [1, 2, 3, 4, 6], "descriptor": [1, 2, 3, 4], "snap": [0, 1, 2, 4, 6], "other": [1, 6], "The": [0, 1, 2, 3, 4], "result": [1, 2], "therefor": [1, 3], "predict": [1, 2], "geometr": 1, "onc": 1, "obtain": 1, "from": [0, 1, 2, 4, 6], "thei": 1, "mai": [1, 2, 3, 4, 6], "directli": 1, "lammp": [1, 2, 3, 4, 5], "high": [1, 2, 3], "molecular": [1, 5], "dynam": 1, "simul": [1, 3], "provid": [0, 2, 4], "level": [0, 2], "connect": 2, "method": 2, "extern": [0, 2], "script": [0, 2, 3, 5], "befor": [2, 4, 6], "have": [2, 4, 6], "directori": [2, 4, 6], "our": [2, 3, 4, 6], "path": [0, 2, 4, 6], "e": [0, 2, 4, 6], "g": [2, 4, 6], "put": [2, 6], "your": [2, 4, 6], "bashrc": [2, 4, 6], "bash_profil": [2, 4, 6], "export": [2, 4, 6], "pythonpath": [2, 4, 6], "A": 2, "load": [2, 3], "first": [0, 2, 3, 6], "paralleltool": [0, 2], "modul": [2, 5, 6], "seen": [0, 2], "exampl": [0, 2, 3, 4], "where": [2, 3, 4], "import": [0, 2, 6], "creat": [2, 6], "instanc": 2, "fitsnap3lib": [0, 2], "parallel_tool": [0, 2], "pt": [0, 2, 3], "io": [0, 2], "arguments_lst": [0, 2], "overwrit": [0, 2], "becaus": 2, "backbon": 2, "store": 2, "all": [2, 3, 6], "data": [2, 3, 4], "arrai": 2, "upon": 2, "which": [2, 3, 4, 6], "class": [2, 4], "distributedlist": 2, "proc_length": 2, "wrap": 2, "list": [2, 3], "ensur": 2, "size": [2, 3, 4], "stai": 2, "same": [2, 3, 6], "allow": [2, 3, 4], "collect": 2, "end": 2, "_len": 2, "int": 2, "length": 2, "distribut": 2, "held": 2, "current": [2, 3], "proc": 2, "_list": 2, "local": 2, "section": [0, 2, 3, 4], "get_list": 2, "return": 2, "deepcopi": 2, "intern": 2, "except": [0, 2], "gracefulerror": 2, "arg": 2, "kwarg": 2, "contain": [2, 4], "across": 2, "multipl": [2, 3], "processor": 2, "check_fitsnap_exist": 2, "bool": 2, "check": [2, 6], "whether": 2, "dictionari": 2, "exist": [2, 3], "new": [2, 6], "one": [2, 4, 6], "set": [0, 2, 3, 4], "fals": 2, "recreat": 2, "new_slice_a": 2, "show": 2, "sub": 2, "matrix": 2, "indic": 2, "belong": 2, "new_slice_b": 2, "b": 2, "new_slice_c": 2, "c": 2, "new_slice_dgrad": 2, "dgrad": 2, "new_slice_t": 2, "type": [2, 3, 4], "after": [2, 3, 6], "configpars": [2, 4], "pars": 2, "suppli": 2, "output": [0, 2], "parse_cmdlin": 2, "can": [0, 2, 3, 4, 6], "command": 2, "line": 2, "includ": 2, "string": 2, "locat": [0, 2], "readi": [2, 3], "object": [0, 2], "now": [2, 3, 4], "hous": 2, "need": [2, 4], "start": [2, 6], "finish": 2, "scraper": [2, 4], "gather": 2, "each": [2, 3, 4], "configur": [2, 4], "ha": [0, 2, 3, 4, 6], "its": [2, 3], "own": [2, 3, 6], "calcul": [2, 3], "numpi": 2, "coeffici": 2, "linear": [2, 3, 4], "delete_data": 2, "boolean": 2, "delet": 2, "true": 2, "make": [2, 6], "loop": [2, 3], "over": [2, 3], "scrape_config": [0, 2], "scrape": [2, 4], "parent": 2, "differ": [2, 3], "svd": [2, 4], "ard": 2, "regress": 2, "jax": 2, "neural": [2, 5, 6], "network": [2, 5, 6], "etc": 2, "name": [2, 3, 4], "declar": [0, 2, 3, 4], "solv": [2, 4], "nonlinear": [2, 3], "error_analysi": 2, "extract": 2, "valu": [2, 4], "truth": 2, "panda": 2, "datafram": 2, "_error": 2, "error": [2, 3, 6], "particular": 2, "group": [2, 3, 4], "_group_error": 2, "_all_error": 2, "inherit": 2, "option": [2, 6], "mliap": 2, "compat": 2, "optim": 2, "torch": [2, 6], "adam": 2, "nn": 2, "per": [2, 3], "attribut": 2, "loss_funct": 2, "loss": [2, 3], "mseloss": 2, "mean": [2, 3], "squar": [2, 3], "learning_r": [2, 3], "float": [2, 4], "rate": [2, 3], "gradient": [2, 3], "descent": [2, 3], "schedul": 2, "lr_schedul": 2, "reducelronplateau": 2, "devic": 2, "none": 2, "acceler": 2, "training_data": 2, "util": 2, "dataset": [2, 4], "piec": 2, "training_load": 2, "dataload": 2, "loader": 2, "create_dataset": 2, "train": [2, 3], "batch": [2, 3], "system": 2, "perform_fit": [0, 2], "sort": 2, "like": [2, 3, 4], "helper": 2, "neural_network": 2, "descriptor_count": 2, "energy_weight": [2, 3], "force_weight": [2, 3], "n_element": 2, "1": [2, 3, 4], "multi_element_opt": [2, 3], "sequenti": 2, "architectur": [2, 3], "element": [2, 3], "weight": [2, 3], "determin": [2, 3, 4], "forc": [2, 3, 4], "number": [2, 3], "differenti": 2, "multi": 2, "forward": 2, "x": 2, "xd": 2, "atoms_per_structur": 2, "xd_indx": 2, "unique_j": 2, "pass": 2, "through": [2, 4], "both": 2, "tensor": 2, "deriv": 2, "ddi": 2, "drj": 2, "long": 2, "contract": 2, "0": [2, 3, 4], "correspond": 2, "uniqu": [2, 3], "j": 2, "import_wb": 2, "bia": 2, "paramet": [2, 3], "layer": [2, 3], "load_lammps_torch": 2, "filenam": 2, "str": [2, 4], "usabl": 2, "write_lammps_torch": 2, "save": 2, "create_torch_network": 2, "layer_s": [2, 3], "also": [0, 2, 3, 4], "standar": 2, "onli": 2, "support": 2, "softplu": 2, "activ": [2, 6], "from_numpi": 2, "ndarrai": 2, "share": [2, 3], "memori": [2, 4], "modif": 2, "reflect": 2, "vice": 2, "versa": 2, "resiz": 2, "It": 2, "accept": 2, "dtype": 2, "float64": 2, "float32": 2, "float16": 2, "complex64": 2, "complex128": 2, "int64": 2, "int32": 2, "int16": 2, "int8": 2, "uint8": 2, "write": [2, 3], "read": 2, "undefin": 2, "behavior": 2, "2": [2, 3, 4], "3": [2, 3], "t": 2, "interfac": [3, 4], "u": 3, "conveni": [3, 4], "md": [3, 4], "These": [0, 3, 4], "capabl": 3, "below": [3, 4, 6], "similarli": 3, "To": 3, "some": [3, 6], "slight": 3, "chang": 3, "add": 3, "tantalum": [3, 4], "look": 3, "num_desc": 3, "60": 3, "5e": 3, "4": [3, 4], "num_epoch": 3, "100": [3, 4], "batch_siz": 3, "save_state_output": 3, "ta_pytorch": 3, "1e": 3, "training_fract": 3, "num_el": 3, "kei": [3, 4], "solver": [3, 5], "more": [3, 4, 6], "detail": [3, 4, 6], "lead": 3, "tell": [3, 4], "node": 3, "equal": 3, "argument": 3, "fast": 3, "minim": 3, "find": 3, "around": 3, "work": [3, 6], "well": 3, "iter": 3, "mani": [3, 4], "config": [0, 3, 5], "averag": 3, "singl": 3, "epoch": 3, "file": [3, 4], "everi": 3, "test": 3, "purpos": 3, "later": 3, "save_state_input": 3, "restart": 3, "scalar": 3, "constant": 3, "multipli": 3, "overrid": [3, 4], "call": 3, "global": 3, "decim": 3, "fraction": 3, "much": 3, "total": 3, "should": [3, 6], "leftov": 3, "portion": 3, "valid": 3, "dure": 3, "handl": 3, "still": 3, "come": [3, 4], "soon": [3, 4], "One": 3, "hot": 3, "encod": 3, "manual_seed_flag": 3, "default": 3, "want": [3, 6], "random": 3, "seed": 3, "debug": 3, "There": [4, 6], "two": 4, "version": [4, 6], "reserv": 4, "most": [4, 6], "basic": 4, "oper": 4, "flexibl": 4, "modifi": 4, "step": 4, "process": 4, "you": [3, 4, 6], "directoi": 4, "environ": 4, "variabl": 4, "place": 4, "Then": [4, 6], "next": [0, 4, 6], "take": 4, "form": 4, "format": 4, "": [4, 6], "nativ": 4, "compos": 4, "section1": 4, "key1": 4, "value1": 4, "key2": 4, "value2": 4, "section2": 4, "key3": 4, "value3": 4, "key4": 4, "value4": 4, "key5": 4, "value5": 4, "aspect": 4, "For": 4, "whose": 4, "comput": 4, "numer": 4, "so": [3, 4], "forth": 4, "github": [0, 4, 6], "repo": [4, 6], "numtyp": 4, "twojmax": 4, "6": 4, "rcutfac": 4, "67637": 4, "rfac0": 4, "99363": 4, "rmin0": 4, "wj": 4, "radelem": 4, "5": 4, "ta": 4, "wselfallflag": 4, "chemflag": 4, "bzeroflag": 4, "quadraticflag": 4, "lammpssnap": 4, "stress": 4, "compute_testerr": 4, "detailed_error": 4, "json": 4, "datapath": 4, "outfil": 4, "metric": 4, "ta_metr": 4, "ta_pot": 4, "refer": [4, 6], "unit": 4, "metal": 4, "atom_styl": 4, "pair_styl": 4, "hybrid": 4, "overlai": 4, "zero": 4, "10": 4, "zbl": 4, "8": 4, "pair_coeff1": 4, "pair_coeff2": 4, "73": 4, "eweight": 4, "fweight": 4, "vweight": 4, "group_sect": 4, "training_s": 4, "testing_s": 4, "group_typ": 4, "smartweight": 4, "random_sampl": 4, "displaced_a15": 4, "00e": 4, "08": 4, "displaced_bcc": 4, "displaced_fcc": 4, "elastic_bcc": 4, "0001": 4, "elastic_fcc": 4, "09": 4, "gsf_110": 4, "gsf_112": 4, "liquid": 4, "67e": 4, "02": 4, "surfac": 4, "volume_a15": 4, "00": 4, "volume_bcc": 4, "volume_fcc": 4, "extra": 4, "dump_descriptor": 4, "dump_truth": 4, "dump_weight": 4, "dump_datafram": 4, "document": 4, "help": 4, "up": [4, 6], "packag": [5, 6], "index": 5, "search": 5, "page": 5, "introduct": 5, "overview": 5, "usag": 5, "instal": 5, "execut": [5, 6], "pytorch": 5, "parallel": 5, "tool": 5, "lib": 5, "few": 6, "ll": 6, "involv": 6, "clone": 6, "git": 6, "http": [0, 6], "com": [0, 6], "ad": 6, "linux": 6, "maco": 6, "manual": 6, "readm": 6, "easiest": 6, "get": 6, "doe": 6, "date": 6, "newer": 6, "featur": 6, "build": 6, "sure": 6, "pip": 6, "proceed": 6, "virtualenv": 6, "pylammp": 6, "cython": 6, "move": 6, "prepar": [0, 6], "makefil": 6, "requir": 6, "cd": 6, "mkdir": 6, "cmake": 6, "dlammps_except": 6, "ye": 6, "dbuild_shared_lib": 6, "dmliap_enable_python": 6, "dpkg_python": 6, "dpkg_ml": 6, "iap": 6, "pace": 6, "dpkg_spin": 6, "might": 6, "observ": [0, 6], "miss": 6, "them": 6, "accordingli": 6, "lmp": 6, "site": 6, "interpret": 6, "produc": 6, "ani": [0, 6], "If": [3, 6], "pleas": 6, "doc": 6, "org": 6, "python_head": 6, "html": 6, "instruct": 6, "proce": 6, "def": 0, "try": 0, "initialize_fitsnap_run": 0, "process_config": 0, "all_barri": 0, "write_output": 0, "abov": 0, "initi": 0, "simpli": 0, "necessari": 0, "rest": 0, "program": 0, "reli": 0, "access": 0, "achiev": 0, "shown": 0, "instati": 0, "did": 0, "order": 0, "desir": 0, "user": 0, "deeper": 0, "control": 0, "varieti": 0, "task": 0, "outsid": 0, "usual": 0, "tree": 0, "master": 0, "specifi": 3}, "objects": {"fitsnap3lib": [[2, 0, 0, "-", "fitsnap"], [2, 0, 0, "-", "parallel_tools"]], "fitsnap3lib.fitsnap": [[2, 1, 1, "", "FitSnap"]], "fitsnap3lib.io": [[2, 0, 0, "-", "input"]], "fitsnap3lib.io.input": [[2, 1, 1, "", "Config"]], "fitsnap3lib.lib.neural_networks": [[2, 0, 0, "-", "pytorch"]], "fitsnap3lib.lib.neural_networks.pytorch": [[2, 1, 1, "", "FitTorch"], [2, 3, 1, "", "create_torch_network"], [2, 3, 1, "", "from_numpy"]], "fitsnap3lib.lib.neural_networks.pytorch.FitTorch": [[2, 2, 1, "", "forward"], [2, 2, 1, "", "import_wb"], [2, 2, 1, "", "load_lammps_torch"], [2, 2, 1, "", "write_lammps_torch"]], "fitsnap3lib.parallel_tools": [[2, 1, 1, "", "DistributedList"], [2, 4, 1, "", "GracefulError"], [2, 1, 1, "", "ParallelTools"]], "fitsnap3lib.parallel_tools.DistributedList": [[2, 2, 1, "", "get_list"]], "fitsnap3lib.parallel_tools.ParallelTools": [[2, 2, 1, "", "new_slice_a"], [2, 2, 1, "", "new_slice_b"], [2, 2, 1, "", "new_slice_c"], [2, 2, 1, "", "new_slice_dgrad"], [2, 2, 1, "", "new_slice_t"]], "fitsnap3lib.solvers": [[2, 0, 0, "-", "pytorch"], [2, 0, 0, "-", "solver"]], "fitsnap3lib.solvers.pytorch": [[2, 1, 1, "", "PYTORCH"]], "fitsnap3lib.solvers.pytorch.PYTORCH": [[2, 2, 1, "", "create_datasets"], [2, 2, 1, "", "perform_fit"]], "fitsnap3lib.solvers.solver": [[2, 1, 1, "", "Solver"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function", "4": "py:exception"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"], "4": ["py", "exception", "Python exception"]}, "titleterms": {"execut": [0, 4], "introduct": 1, "overview": [1, 2], "fitsnap": [1, 2, 4, 5], "librari": [2, 4], "parallel": 2, "tool": 2, "config": 2, "solver": [2, 4], "pytorch": [2, 3], "lib": 2, "fittorch": 2, "model": 3, "fit": 3, "neural": 3, "network": 3, "potenti": 3, "run": 4, "input": 4, "script": 4, "bispectrum": 4, "calcul": 4, "eshift": 4, "welcom": 5, "": 5, "document": 5, "indic": 5, "tabl": 5, "user": 5, "guid": 5, "programm": 5, "usag": 6, "instal": 6, "minim": 6, "conda": 6, "environ": 6, "custom": 6, "newest": 6, "lammp": 6}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 56}})